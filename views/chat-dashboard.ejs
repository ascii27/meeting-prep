<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meeting Intelligence - Chat Assistant</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/chat-primary.css">
  <link rel="stylesheet" href="/css/chat-components.css">
</head>
<body class="chat-primary-layout">
  <!-- Header with minimal profile info -->
  <header class="chat-header">
    <div class="header-left">
      <div class="logo-compact">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path>
        </svg>
        <h1>Meeting Intelligence</h1>
      </div>
    </div>
    
    <div class="header-center">
      <div class="context-indicator" id="context-indicator">
        <span class="context-text">Ready to help with your meetings</span>
        <div class="context-status active"></div>
      </div>
    </div>
    
    <div class="header-right">
      <div class="user-profile-compact">
        <img src="<%= profileImage || '/img/default-profile.svg' %>" alt="Profile" class="profile-image-small" onerror="this.src='/img/default-profile.svg';">
        <span class="user-name-small"><%= name %></span>
      </div>
      <div class="header-actions">
        <button id="view-toggle" class="view-toggle-btn" title="Toggle traditional view">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="9" y1="9" x2="15" y2="15"></line>
            <line x1="15" y1="9" x2="9" y2="15"></line>
          </svg>
        </button>
        <a href="/auth/logout" class="logout-btn-compact">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16,17 21,12 16,7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
        </a>
      </div>
    </div>
  </header>

  <!-- Main chat-first layout -->
  <main class="chat-main-container">
    <!-- Primary chat interface -->
    <div class="chat-primary-panel">
      <div class="chat-conversation" id="chat-conversation">
        <!-- Welcome message -->
        <div class="chat-message assistant welcome-message">
          <div class="message-avatar">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path>
            </svg>
          </div>
          <div class="message-content">
            <div class="message-text">
              <h3>üëã Welcome to Meeting Intelligence!</h3>
              <p>I'm your AI assistant for all things meeting-related. I can help you:</p>
              <ul>
                <li>Find information about past and upcoming meetings</li>
                <li>Analyze collaboration patterns and relationships</li>
                <li>Search through meeting documents and notes</li>
                <li>Understand organizational dynamics and hierarchies</li>
                <li>Generate insights and summaries</li>
              </ul>
            </div>
            
            <!-- Quick start suggestions -->
            <div class="quick-suggestions">
              <h4>Try asking me:</h4>
              <div class="suggestion-grid">
                <button class="suggestion-card" data-query="Show me meetings from this week">
                  <div class="suggestion-icon">üìÖ</div>
                  <div class="suggestion-text">This week's meetings</div>
                </button>
                <button class="suggestion-card" data-query="Who did I meet with most recently?">
                  <div class="suggestion-icon">üë•</div>
                  <div class="suggestion-text">Recent participants</div>
                </button>
                <button class="suggestion-card" data-query="Find documents from yesterday's meetings">
                  <div class="suggestion-icon">üìÑ</div>
                  <div class="suggestion-text">Meeting documents</div>
                </button>
                <button class="suggestion-card" data-query="Show me my team's collaboration patterns">
                  <div class="suggestion-icon">üîó</div>
                  <div class="suggestion-text">Collaboration insights</div>
                </button>
                <button class="suggestion-card" data-query="What are the trending topics in our meetings?">
                  <div class="suggestion-icon">üìà</div>
                  <div class="suggestion-text">Trending topics</div>
                </button>
                <button class="suggestion-card" data-query="Show me the organizational hierarchy">
                  <div class="suggestion-icon">üè¢</div>
                  <div class="suggestion-text">Organization chart</div>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Chat input area -->
      <div class="chat-input-area">
        <div class="input-suggestions" id="input-suggestions">
          <!-- Dynamic suggestions will appear here -->
        </div>
        
        <div class="chat-input-container">
          <div class="input-wrapper">
            <textarea 
              id="chat-input" 
              placeholder="Ask me anything about your meetings..." 
              rows="1"
              maxlength="1000"
            ></textarea>
            <div class="input-actions">
              <button id="attach-btn" class="input-action-btn" title="Attach context">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                </svg>
              </button>
              <button id="send-btn" class="send-btn" disabled>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="22" y1="2" x2="11" y2="13"></line>
                  <polygon points="22,2 15,22 11,13 2,9"></polygon>
                </svg>
              </button>
            </div>
          </div>
          
          <div class="input-footer">
            <div class="input-hints">
              <small>üí° Try natural language like "Show me meetings with John about planning"</small>
            </div>
            <div class="input-counter">
              <span id="char-counter">0/1000</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Context sidebar (collapsible) -->
    <div class="context-sidebar" id="context-sidebar">
      <div class="sidebar-header">
        <h3>Context & Insights</h3>
        <button id="sidebar-toggle" class="sidebar-toggle">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15,18 9,12 15,6"></polyline>
          </svg>
        </button>
      </div>
      
      <div class="sidebar-content">
        <!-- Recent conversations -->
        <div class="context-section">
          <h4>Recent Conversations</h4>
          <div id="recent-conversations" class="conversation-list">
            <!-- Will be populated dynamically -->
          </div>
        </div>
        
        <!-- Quick stats -->
        <div class="context-section">
          <h4>Quick Stats</h4>
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-number" id="meetings-this-week">-</div>
              <div class="stat-label">This Week</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="participants-count">-</div>
              <div class="stat-label">Participants</div>
            </div>
            <div class="stat-item">
              <div class="stat-number" id="documents-count">-</div>
              <div class="stat-label">Documents</div>
            </div>
          </div>
        </div>
        
        <!-- Trending topics -->
        <div class="context-section">
          <h4>Trending Topics</h4>
          <div id="trending-topics" class="topic-list">
            <!-- Will be populated dynamically -->
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Traditional view overlay (hidden by default) -->
  <div id="traditional-view" class="traditional-view-overlay" style="display: none;">
    <div class="traditional-view-content">
      <div class="traditional-header">
        <h2>Traditional Dashboard View</h2>
        <button id="close-traditional" class="close-traditional">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      
      <!-- Traditional dashboard content will be loaded here -->
      <div id="traditional-dashboard-content">
        <!-- This will contain the traditional week view -->
      </div>
    </div>
  </div>

  <!-- Loading overlay -->
  <div id="loading-overlay" class="loading-overlay" style="display: none;">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p>Processing your request...</p>
    </div>
  </div>

  <script src="/js/chat-primary.js"></script>
  <script src="/js/chat-components.js"></script>
  <script src="/js/chat-intelligence.js"></script>
</body>
</html>
